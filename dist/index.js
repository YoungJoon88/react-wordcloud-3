function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var e=t(require("lodash.debounce")),n=require("react"),r=t(n),a=require("d3-selection"),o=t(require("resize-observer-polyfill"));require("d3-transition");var i=require("d3-array"),s=t(require("d3-cloud")),u=t(require("lodash.clonedeep")),l=t(require("lodash.isempty")),c=t(require("seedrandom")),f=t(require("tippy.js")),d=require("d3-dispatch"),h=require("d3-scale"),y=require("d3-scale-chromatic");function v(){return(v=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var x=Math.PI/180;function p(t){return t.text}function g(){return"serif"}function m(){return"normal"}function b(t){return Math.sqrt(t.value)}function w(){return 30*(~~(6*Math.random())-3)}function M(){return 1}function z(t,e,n,r){if(!e.sprite){var a=t.context,o=t.ratio;a.clearRect(0,0,2048/o,2048/o);var i=0,s=0,u=0,l=n.length;for(--r;++r<l;){e=n[r],a.save(),a.font=e.style+" "+e.weight+" "+~~((e.size+1)/o)+"px "+e.font;var c=a.measureText(e.text+"m").width*o,f=e.size<<1;if(e.rotate){var d=Math.sin(e.rotate*x),h=Math.cos(e.rotate*x),y=c*h,v=c*d,p=f*h,g=f*d;c=Math.max(Math.abs(y+g),Math.abs(y-g))+31>>5<<5,f=~~Math.max(Math.abs(v+p),Math.abs(v-p))}else c=c+31>>5<<5;if(f>u&&(u=f),i+c>=2048&&(i=0,s+=u,u=0),s+f>=2048)break;a.translate((i+(c>>1))/o,(s+(f>>1))/o),e.rotate&&a.rotate(e.rotate*x),a.fillText(e.text,0,0),e.padding&&(a.lineWidth=2*e.padding,a.strokeText(e.text,0,0)),a.restore(),e.width=c,e.height=f,e.xoff=i,e.yoff=s,e.x1=c>>1,e.y1=f>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,i+=c}for(var m=a.getImageData(0,0,2048/o,2048/o).data,b=[];--r>=0;)if((e=n[r]).hasText){for(var w=(c=e.width)>>5,M=(f=e.y1-e.y0,0);M<f*w;M++)b[M]=0;if(null==(i=e.xoff))return;s=e.yoff;for(var z=0,W=-1,q=0;q<f;q++){for(M=0;M<c;M++){var k=m[2048*(s+q)+(i+M)<<2]?1<<31-M%32:0;b[w*q+(M>>5)]|=k,z|=k}z?W=q:(e.y0++,f--,q--,s++)}e.y1=e.y0+W,e.sprite=b.slice(0,(e.y1-e.y0)*w)}}}function W(t,e,n){for(var r,a=t.sprite,o=t.width>>5,i=t.x-(o<<4),s=127&i,u=32-s,l=t.y1-t.y0,c=(t.y+t.y0)*(n>>=5)+(i>>5),f=0;f<l;f++){r=0;for(var d=0;d<=o;d++)if((r<<u|(d<o?(r=a[f*o+d])>>>s:0))&e[c+d])return!0;c+=n}return!1}function q(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function k(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function S(){return document.createElement("canvas")}function O(t){return"function"==typeof t?t:function(){return t}}var T={archimedean:k,rectangular:function(t){var e=4*t[0]/t[1],n=0,r=0;return function(t){var a=t<0?-1:1;switch(Math.sqrt(1+4*a*t)-a&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4}return[n,r]}}};function j(t,e){return t[Math.floor(e()*t.length)]}function A(t){return t.size+"px"}function E(t){return t.text}function C(t){return"translate("+t.x+", "+t.y+")"+("number"==typeof t.rotate?"rotate("+t.rotate+")":"")}function I(t){var e,n=t.callbacks,r=t.maxWords,o=t.options,y=t.selection,x=t.size,I=t.activeWords,R=o.deterministic,D=o.enableOptimizations,F=o.fontFamily,L=o.fontStyle,P=o.fontSizes,H=o.fontWeight,N=o.padding,U=o.randomSeed,V=o.rotations,B=o.rotationAngles,G=o.spiral,J=o.scale,K=t.words.concat().sort(function(t,e){return i.descending(t.value,e.value)}).slice(0,r),Q=c(R?U||"deterministic":null);(e=D?function(){var t=[256,256],e=p,n=g,r=b,a=m,o=m,i=w,s=M,u=k,l=[],c=Infinity,f=d.dispatch("word","end"),h=Math.random,y={},v=S,x=!1;function j(e,n,r){for(var a,o,i,s,l,c=n.x,f=n.y,d=Math.sqrt(t[0]*t[0]+t[1]*t[1]),y=u(t),v=h()<.5?1:-1,x=-v;(a=y(x+=v))&&(o=~~a[0],i=~~a[1],!(Math.min(Math.abs(o),Math.abs(i))>=d));)if(n.x=c+o,n.y=f+i,!(n.x+n.x0<0||n.y+n.y0<0||n.x+n.x1>t[0]||n.y+n.y1>t[1]||r&&W(n,e,t[0])||r&&!((s=n).x+s.x1>(l=r)[0].x&&s.x+s.x0<l[1].x&&s.y+s.y1>l[0].y&&s.y+s.y0<l[1].y))){for(var p,g=n.sprite,m=n.width>>5,b=t[0]>>5,w=n.x-(m<<4),M=127&w,z=32-M,q=n.y1-n.y0,k=(n.y+n.y0)*b+(w>>5),S=0;S<q;S++){p=0;for(var O=0;O<=m;O++)e[k+O]|=p<<z|(O<m?(p=g[S*m+O])>>>M:0);k+=b}return delete n.sprite,!0}return!1}return y.canvas=function(t){return arguments.length?(v=O(t),y):v},y.start=function(){var u=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,1,1).data.length>>2);t.width=2048/e,t.height=2048/e;var n=t.getContext("2d",{willReadFrequently:!0});return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}(v()),c=new Uint32Array((t[0]>>5)*t[1]),d=null,p=[],g=l.map(function(t,u){return t.text=e.call(this,t,u),t.font=n.call(this,t,u),t.style=a.call(this,t,u),t.weight=o.call(this,t,u),t.rotate=i.call(this,t,u),t.size=~~r.call(this,t,u),t.padding=s.call(this,t,u),t}).sort(function(t,e){return e.size-t.size});return setTimeout(function(){return function e(n){var r=50*n,a=Math.min(50*(n+1),l.length);!function(e,n){for(var r=e;r<n;r+=1){var a=g[r];a.x=t[0]*(h()+.5)>>1,a.y=t[1]*(h()+.5)>>1,z(u,a,g,r),a.hasText&&j(c,a,d)&&(p.push(a),f.call("word",y,a),d?q(d,a):d=[{x:a.x+a.x0,y:a.y+a.y0},{x:a.x+a.x1,y:a.y+a.y1}],a.x-=t[0]>>1,a.y-=t[1]>>1)}}(r,a),x||(a<l.length?setTimeout(function(){return e(n+1)},0):(y.stop(),f.call("end",y,p,d)))}(0)},0),y},y.revive=function(){return x=!1,y},y.stop=function(){return x=!0,y},y.timeInterval=function(t){return arguments.length?(c=null==t?Infinity:t,y):c},y.words=function(t){return arguments.length?(l=t,y):l},y.size=function(e){return arguments.length?(t=[+e[0],+e[1]],y):t},y.font=function(t){return arguments.length?(n=O(t),y):n},y.fontStyle=function(t){return arguments.length?(a=O(t),y):a},y.fontWeight=function(t){return arguments.length?(o=O(t),y):o},y.rotate=function(t){return arguments.length?(i=O(t),y):i},y.text=function(t){return arguments.length?(e=O(t),y):e},y.spiral=function(t){return arguments.length?(u=T[t]||t,y):u},y.fontSize=function(t){return arguments.length?(r=O(t),y):r},y.padding=function(t){return arguments.length?(s=O(t),y):s},y.random=function(t){return arguments.length?(h=t,y):h},y.on=function(){var t=f.on.apply(f,arguments);return t===f?y:t},y}():s()).size(x).padding(N).words(u(K)).rotate(function(){return void 0===V?30*(~~(6*Q())-3):function(t,e,n){if(t<1)return 0;var r=[];if(1===t)r=[e[0]];else{r=[].concat(e);for(var a=(e[1]-e[0])/(t-1),o=e[0]+a;o<e[1];)r.push(o),o+=a}return j(r,n)}(V,B,Q)}).spiral(G).random(Q).text(E).font(F).fontStyle(L).fontWeight(H),function t(r,s){void 0===s&&(s=1),D&&e.revive(),e.fontSize(function(t){return function(t,e,n){var r,a=i.min(t,function(t){return Number(t.value)}),o=i.max(t,function(t){return Number(t.value)});switch(n){case"log":r=h.scaleLog;break;case"sqrt":r=h.scaleSqrt;break;case"linear":default:r=h.scaleLinear}return r().domain([a,o]).range(e)}(K,r,J)(t.value)}).on("end",function(e){if(K.length!==e.length&&s<=10){10===s&&console.warn("Unable to layout "+(K.length-e.length)+" word(s) after "+s+" attempts.  Consider: (1) Increasing the container/component size. (2) Lowering the max font size. (3) Limiting the rotation angles.");var i=Math.max(.95*r[0],1);t([i,Math.max(.95*r[1],i)],s+1)}else!function(t){var e,n=t.callbacks,r=t.options,o=t.random,i=t.words,s=t.activeWords,u=n.getWordColor,c=n.getWordTooltip,d=n.onWordClick,h=n.onWordMouseOver,y=n.onWordMouseOut,x=r.colors,p=r.enableTooltip,g=r.fontStyle,m=r.fontWeight,b=r.textAttributes,w=r.tooltipOptions,M=r.fontFamily,z=r.transitionDuration;function W(t){return!l(s)&&s.includes(t.text)?"active":"in-active"}function q(t){return u?u(t):j(x,o)}t.selection.selectAll("text").data(i).join(function(t){var n=t.append("text").on("click",function(t){d&&d(t,a.event)}).on("mouseover",function(t){!p||e&&!e.isDestroyed||(e=f(a.event.target,v({animation:"scale",arrow:!0,content:function(){return c(t)},onHidden:function(t){t.destroy(),e=null}},w))),h&&h(t,a.event)}).on("mouseout",function(t){e&&!e.state.isVisible&&e.destroy(),y&&y(t,a.event)}).attr("cursor",d?"pointer":"default").attr("fill",q).attr("font-family",M).attr("font-style",g).attr("font-weight",m).attr("text-anchor","middle").attr("transform","translate(0, 0) rotate(0)");"object"==typeof b&&Object.keys(b).forEach(function(t){n=n.attr(t,b[t])}),n=n.call(function(t){return t.transition().duration(z).attr("class",W).attr("font-size",A).attr("transform",C).text(E)})},function(t){t.transition().duration(z).attr("class",W).attr("fill",q).attr("font-family",M).attr("font-size",A).attr("transform",C).text(E)},function(t){t.transition().duration(z).attr("fill-opacity",0).remove()})}({callbacks:n,options:o,random:Q,selection:y,words:e,activeWords:I})}).start()}(P)}var R=["callbacks","maxWords","minSize","options","size","words","activeWords"],D={getWordTooltip:function(t){return t.text+" ("+t.value+")"}},F={colors:i.range(20).map(function(t){return t.toString()}).map(h.scaleOrdinal(y.schemeCategory10)),deterministic:!1,enableOptimizations:!1,enableTooltip:!0,fontFamily:"times new roman",fontSizes:[4,32],fontStyle:"normal",fontWeight:"normal",padding:1,rotationAngles:[-90,90],scale:"sqrt",spiral:"rectangular",tooltipOptions:{},transitionDuration:600};function L(t){var i=t.callbacks,s=t.maxWords,u=void 0===s?100:s,l=t.minSize,c=t.options,f=t.size,d=t.words,h=t.activeWords,y=function(t,e){if(null==t)return{};var n,r,a={},o=Object.keys(t);for(r=0;r<o.length;r++)e.indexOf(n=o[r])>=0||(a[n]=t[n]);return a}(t,R),x=function(t,e,r){var i=n.useRef(),s=n.useState(e),u=s[0],l=s[1],c=n.useState(null),f=c[0],d=c[1];return n.useEffect(function(){var n=i.current,s=a.select(n).append("svg").style("display","block");"object"==typeof r&&Object.keys(r).forEach(function(t){s=s.attr(t,r[t])});var u=s.append("g");function c(t,e){s.attr("height",e).attr("width",t),u.attr("transform","translate("+t/2+", "+e/2+")"),l([t,e])}d(u);var f=0,h=0;void 0===e?(f=n.parentElement.offsetWidth,h=n.parentElement.offsetHeight):(f=e[0],h=e[1]),c(f=Math.max(f,t[0]),h=Math.max(h,t[1]));var y=new o(function(t){if(t&&0!==t.length&&void 0===e){var n=t[0].contentRect;c(n.width,n.height)}});return y.observe(n),function(){y.unobserve(n),a.select(n).selectAll("*").remove()}},[e,t,r]),[i,f,u]}(l,f,c.svgAttributes),p=x[0],g=x[1],m=x[2],b=n.useRef(e(I,100));return n.useEffect(function(){if(g){var t=v({},D,i),e=v({},F,c);b.current({callbacks:t,maxWords:u,options:e,selection:g,size:m,words:d,activeWords:h})}},[u,i,c,g,m,d,h]),r.createElement("div",v({ref:p,style:{height:"100%",width:"100%"}},y))}L.defaultProps={callbacks:D,maxWords:100,minSize:[300,300],options:F},exports.default=L,exports.defaultCallbacks=D,exports.defaultOptions=F;
//# sourceMappingURL=index.js.map
